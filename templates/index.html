{% extends 'base.html' %}
{% block title %}HanapEskwela — Home{% endblock %}
{% block content %}
<style>
  .hero-section {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 40px;
    flex-wrap: wrap;
    transition: opacity 0.4s ease;
  }
  .hero-text {
    flex: 1;
    color: #2E7D32;
    font-size: 120px;
    font-weight: bold;
    margin-top: 20px;
    opacity: 0.7;
  }
  .hero-description {
    color: #333;
    font-size: 16px;
    margin-top: 10px;
  }
  .slideshow-box {
    flex: 1;
    max-width: 500px;
    height: 350px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    position: relative;
  }
  .slide {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
    display: none;
  }
  .slide.active {
    display: block;
  }
  .search-filter-bar {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 12px;
    padding: 20px 40px;
  }
  #search-bar, #type-filter {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }
  #school-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    padding: 40px;
  }
  .hidden {
    opacity: 0;
    pointer-events: none;
    height: 0;
    overflow: hidden;
  }

  /* ===== SCHOOL GRID CARDS ===== */
  .school-card {
    background: #f7fff5;
    border: 1px solid #c8e6c9;
    border-radius: 12px;
    padding: 20px;
    margin: 10px;
    text-align: left;
    cursor: pointer;
    transition: 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }
  .school-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  /* ===== MODAL BOX ===== */
  .school-modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    align-items: center;
    justify-content: center;
    z-index: 999;
  }
  .school-modal.show {
    display: flex;
  }
  .school-modal-content {
    background: #fff;
    border-radius: 16px;
    padding: 30px;
    width: 90%;
    max-width: 500px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    position: relative;
    animation: fadeIn 0.3s ease;
  }
  .school-modal-content img {
    width: 100%;
    height: 220px;
    object-fit: cover;
    border-radius: 12px;
    margin-bottom: 15px;
  }
  .back-btn {
    position: absolute;
    top: 10px;
    left: 10px;
    background: #2e7d32;
    color: #fff;
    border: none;
    border-radius: 6px;
    padding: 6px 10px;
    cursor: pointer;
  }
  .apply-btn {
    display: inline-block;
    margin-top: 15px;
    background: #388e3c;
    color: white;
    padding: 10px 16px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
  }
  .apply-btn:hover {
    background: #2e7d32;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }
</style>

<div class="search-filter-bar">
  <input id="search-bar" placeholder="Search schools..." />
  <select id="type-filter">
    <option value="none">Filter by type</option>
    <option value="public">Public</option>
    <option value="private">Private</option>
  </select>
</div>

<div class="hero-section" id="hero-section">
  <div>
    <div class="hero-text">Hanap Eskwela</div>
    <div class="hero-description">Find the right college school for you in Laguna — public or private.</div>
  </div>
  <div class="slideshow-box">
    <img class="slide active" src="https://d2nnykqiaju69u.cloudfront.net/pslife_photos/pat_temp/Laguna%20State%20Polytechnic%20University%20fire%20kill%20student%20inner%20image.jpg" />
    <img class="slide" src="https://getaway.ph/storage/2020/06/IMG-20200307-WA0017-01.jpeg" />
    <img class="slide" src="https://www.pacu.org.ph/wordpress/wp-content/uploads/2017/05/Lyceum-of-the-Philippines-Laguna.jpg" />
  </div>
</div>

<div id="school-grid"></div>

<!-- Modal Box -->
<div id="school-modal" class="school-modal">
  <div class="school-modal-content">
    <button id="back-button" class="back-btn">← Back</button>
    <img id="modal-school-img" src="" alt="School Image" />
    <h2 id="modal-school-name"></h2>
    <p id="modal-school-desc"></p>
    <p id="modal-school-type"></p>
    <p id="modal-school-place"></p>
    <p id="modal-school-slots"></p>
    <a id="modal-apply-link" href="#" target="_blank" class="apply-btn">Apply Now</a>
  </div>
</div>

<script>
// --- Slideshow logic ---
const slides = document.querySelectorAll('.slide');
let currentSlide = 0;
function showSlide(index) {
  slides.forEach((slide, i) => {
    slide.classList.toggle('active', i === index);
  });
}
function nextSlide() {
  currentSlide = (currentSlide + 1) % slides.length;
  showSlide(currentSlide);
}
showSlide(currentSlide);
setInterval(nextSlide, 4000);

// --- School Data ---
const schools = [
  {
    name: "Laguna State Polytechnic University",
    type: "public",
    place: "Siniloan",
    img: "https://via.placeholder.com/400x200?text=LSPU",
    desc: "A leading public university in Laguna offering a variety of degree programs.",
    slots: "Open",
    link: "https://lspu.edu.ph/"
  },
  {
    name: "University of the Philippines Los Baños",
    type: "public",
    place: "Los Baños",
    img: "https://via.placeholder.com/400x200?text=UPLB",
    desc: "Top national university with strong focus on research and agriculture.",
    slots: "Few",
    link: "https://uplb.edu.ph/"
  },
  {
    name: "Lyceum of the Philippines Laguna",
    type: "private",
    place: "Calamba",
    img: "https://via.placeholder.com/400x200?text=Lyceum+Laguna",
    desc: "A private university committed to developing professionals and leaders.",
    slots: "Limited",
    link: "https://lpulaguna.edu.ph/"
  },
  {
    name: "San Sebastian College Recoletos – Canlubang",
    type: "private",
    place: "Canlubang",
    img: "https://via.placeholder.com/400x200?text=SSCR",
    desc: "Private Catholic school offering quality education in the south.",
    slots: "Open",
    link: "https://sscrc.edu.ph/"
  }
];

// --- Elements ---
const schoolGrid = document.getElementById("school-grid");
const heroSection = document.getElementById("hero-section");
const searchBar = document.getElementById("search-bar");
const typeFilter = document.getElementById("type-filter");
const homeLink = document.getElementById("home-link");

// Modal Elements
const modal = document.getElementById("school-modal");
const backButton = document.getElementById("back-button");
const modalName = document.getElementById("modal-school-name");
const modalImg = document.getElementById("modal-school-img");
const modalDesc = document.getElementById("modal-school-desc");
const modalType = document.getElementById("modal-school-type");
const modalPlace = document.getElementById("modal-school-place");
const modalSlots = document.getElementById("modal-school-slots");
const modalApply = document.getElementById("modal-apply-link");

// --- Render Schools ---
function renderSchools(filteredSchools) {
  schoolGrid.innerHTML = "";
  if (filteredSchools.length === 0) {
    schoolGrid.innerHTML = "<p>No schools found.</p>";
    return;
  }
  filteredSchools.forEach(school => {
    const div = document.createElement("div");
    div.className = "school-card";
    div.innerHTML = `
      <h3>${school.name}</h3>
      <div class="school-type">${school.type.charAt(0).toUpperCase() + school.type.slice(1)}</div>
      <p>${school.place}</p>
    `;
    div.addEventListener("click", () => openModal(school));
    schoolGrid.appendChild(div);
  });
}

// --- Filter Logic ---
function filterSchools() {
  const searchValue = searchBar.value.toLowerCase();
  const typeValue = typeFilter.value;

  if (searchValue === "" && typeValue === "none") {
    schoolGrid.innerHTML = "";
    heroSection.classList.remove("hidden");
    return;
  }

  heroSection.classList.add("hidden");

  const filtered = schools.filter(school => {
    const matchesSearch = school.name.toLowerCase().includes(searchValue);
    const matchesType = typeValue === "none" || school.type === typeValue;
    return matchesSearch && matchesType;
  });

  renderSchools(filtered);
}

// --- Modal Logic ---
function openModal(school) {
  modal.classList.add("show");
  modalName.textContent = school.name;
  modalImg.src = school.img;
  modalDesc.textContent = school.desc;
  modalType.textContent = `Type: ${school.type}`;
  modalPlace.textContent = `Location: ${school.place}`;
  modalSlots.textContent = `Slots: ${school.slots}`;
  modalApply.href = school.link;
}
function closeModal() {
  modal.classList.remove("show");
}
backButton.addEventListener("click", closeModal);
modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });

// --- Event Listeners ---
searchBar.addEventListener("input", filterSchools);
typeFilter.addEventListener("change", filterSchools);

// --- Home reset ---
if (homeLink) {
  homeLink.addEventListener("click", () => {
    heroSection.classList.remove("hidden");
    schoolGrid.innerHTML = "";
    searchBar.value = "";
    typeFilter.value = "none";
    closeModal();
  });
}
</script>
{% endblock %}
