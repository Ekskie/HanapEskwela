{% extends 'base.html' %}
{% block title %}HanapEskwela ‚Äî Welcome{% endblock %}
{% block content %}

<style>
  /* Landing Page Specific Styles */
  .landing-hero {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    width: 100%;
    min-height: 90vh; /* Covers most of the screen */
    overflow: hidden;
    background: #000;
  }

  /* Slideshow Background Container */
  .slideshow-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }

  /* Individual Slides */
  .slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 1.5s ease-in-out;
  }

  .slide.active {
    opacity: 1;
  }

  /* Dark Overlay for Text Readability */
  .overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* 50% opacity black */
    z-index: 1;
  }

  /* Content Styling (above overlay) */
  .landing-text {
    position: relative;
    z-index: 2;
    max-width: 800px;
    padding: 20px;
    color: white;
    animation: fadeIn 1s ease-out;
  }

  .landing-text h1 {
    font-size: 64px;
    color: white; /* Changed to white for contrast */
    margin: 0 0 20px 0;
    line-height: 1.1;
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
  }

  .landing-text p {
    font-size: 22px;
    color: #f1f1f1;
    line-height: 1.6;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    margin-bottom: 40px;
  }

  .cta-buttons {
    display: flex;
    gap: 20px;
    justify-content: center;
  }

  .cta-btn {
    padding: 15px 40px;
    border-radius: 30px;
    font-size: 18px;
    font-weight: bold;
    text-decoration: none;
    transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
  }

  .btn-login {
    background-color: transparent;
    color: white;
    border: 2px solid white;
  }
  .btn-login:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }

  .btn-register {
    background-color: #2E7D32;
    color: white;
    border: 2px solid #2E7D32;
    box-shadow: 0 4px 15px rgba(46, 125, 50, 0.5);
  }
  .btn-register:hover {
    background-color: #1b5e20;
    border-color: #1b5e20;
  }

  .cta-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  }

  /* Location Caption (Optional) */
  .slide-caption-corner {
    position: absolute;
    bottom: 20px;
    right: 20px;
    z-index: 2;
    color: rgba(255,255,255,0.7);
    background: rgba(0,0,0,0.4);
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 14px;
    font-style: italic;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @media (max-width: 768px) {
    .landing-text h1 { font-size: 42px; }
  }
</style>

<div class="landing-hero">
  <!-- Background Slideshow -->
  <div class="slideshow-bg" id="slideshow-box">
    <!-- JavaScript will insert images here -->
  </div>

  <!-- Dark Overlay -->
  <div class="overlay"></div>

  <!-- Centered Content -->
  <div class="landing-text">
    <h1>Hanap Eskwela</h1>
    <p>Discover the best higher education institutions in Laguna. View locations, compare tuition, and find your perfect academic match.</p>
    
    <!-- CTA Buttons -->
    <div class="cta-buttons">
      <a href="{{ url_for('login') }}" class="cta-btn btn-login">Login</a>
      <a href="{{ url_for('register') }}" class="cta-btn btn-register">Get Started</a>
    </div>
  </div>

  <!-- Caption Display -->
  <div id="location-caption" class="slide-caption-corner" style="display:none;"></div>
</div>

<script>
  // School Data passed from backend
  const schools = {{ schools | tojson }};
  const container = document.getElementById('slideshow-box');
  const captionBox = document.getElementById('location-caption');
  
  // Filter schools that actually have images
  const validSchools = schools.filter(s => s.img && s.img.trim() !== "");
  // Default images if database is empty
  const defaultImages = [
      "https://getaway.ph/storage/2020/06/IMG-20200307-WA0017-01.jpeg",
      "https://d2nnykqiaju69u.cloudfront.net/pslife_photos/pat_temp/Laguna%20State%20Polytechnic%20University%20fire%20kill%20student%20inner%20image.jpg",
      "https://www.pacu.org.ph/wordpress/wp-content/uploads/2017/05/Lyceum-of-the-Philippines-Laguna.jpg"
  ];

  function initSlideshow() {
      container.innerHTML = "";
      
      const itemsToRender = validSchools.length > 0 ? validSchools : defaultImages.map(url => ({ img: url, name: "Hanap Eskwela" }));

      itemsToRender.forEach((item, index) => {
          // Image
          const img = document.createElement('img');
          img.src = item.img;
          img.className = index === 0 ? 'slide active' : 'slide';
          img.alt = item.name;
          img.dataset.schoolName = item.name;
          img.onerror = function() { this.style.display='none'; }; 
          
          container.appendChild(img);
      });
      
      // Initial Caption
      updateCaption(0);

      // Start Cycle if we have multiple images
      if (itemsToRender.length > 1) {
          let currentSlide = 0;
          const slides = container.getElementsByClassName('slide');
          
          setInterval(() => {
              // Hide current
              slides[currentSlide].classList.remove('active');
              // Calculate next
              currentSlide = (currentSlide + 1) % slides.length;
              // Show next
              slides[currentSlide].classList.add('active');
              // Update caption
              updateCaption(currentSlide);
          }, 5000); // 5 seconds per slide for a slower pace
      }

      function updateCaption(index) {
          if (itemsToRender[index] && itemsToRender[index].name) {
              captionBox.innerText = "üìç " + itemsToRender[index].name;
              captionBox.style.display = 'block';
          }
      }
  }

  document.addEventListener('DOMContentLoaded', initSlideshow);
</script>
{% endblock %}